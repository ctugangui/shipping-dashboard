# Prompt 012.1: Docker Build Fixes

**Role:** Senior DevOps Engineer & TypeScript Expert
**Context:** We are attempting to build a Docker container for our Node.js/Fastify app, but the build is failing with specific TypeScript and Prisma errors.
**Goal:** Fix the code and configuration to allow `npm run build` to succeed inside the Docker environment.

# Errors to Fix

## 1. Missing EJS Types (TS7016)
* **Error:** `Could not find a declaration file for module 'ejs'.`
* **Fix:** Install the types as a dev dependency.
    * Command: `npm install --save-dev @types/ejs`

## 2. Prisma RootDir Issue (TS6059)
* **Error:** `File '/app/generated/prisma/client.ts' is not under 'rootDir' '/app/src'.`
* **File:** `tsconfig.json`
* **Fix:**
    * Remove the `"rootDir": "./src"` line from `compilerOptions`.
    * *Reason:* The Docker build generates the Prisma client outside the `src` folder, causing strict directory checks to fail.

## 3. Transaction Type Mismatch (TS2769)
* **Error:** `Argument of type '(tx: typeof prisma) => Promise<void>' is not assignable to parameter of type 'PrismaPromise<any>[]'.`
* **File:** `src/services/ShipmentService.ts` (Around line 177)
* **Fix:**
    * Remove the explicit type annotation `: typeof prisma` from the transaction callback argument.
    * Let Prisma infer the transaction client type automatically.
    * Change: `async (tx: typeof prisma)` -> `async (tx)`

## 4. UPS Response Type Mismatch (TS2345)
* **Error:** `Type '{ shipment?: unknown[] | undefined; }' is not assignable to type '{ shipment?: UpsShipment[] | undefined; }'.`
* **File:** `src/services/UpsTrackingService.ts` (Around line 93)
* **Fix:**
    * Add a type assertion (`as`) to the response data to satisfy the TypeScript compiler.
    * Ensure `response.trackResponse` is treated as the correct type expected by `UpsTrackResponse`.

# Verification Instructions
1.  Run `npm run build` locally to ensure the fixes work.
2.  Run `docker-compose up --build` to confirm the Docker container builds and starts successfully.